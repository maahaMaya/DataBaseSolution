USE Pratice;
-- CLAUSE 
CREATE TABLE EMPDETAILS ( EMPNO INT PRIMARY KEY, ENAME VARCHAR(30), JOB VARCHAR(30), HIREDATE DATE, SLARAY MONEY , DEPTNO INT);
SP_RENAME 'EMPDETAILS.SLARAY', 'SALARY'; 
INSERT INTO EMPDETAILS VALUES 
(7369, 'SMITH', 'CLERK', '1980-12-17', 8000, 20), 
(7499, 'ALLEN', 'SALESMAN', '1982-02-09', 57000, 30), 
(7521, 'WARD', 'SALESMAN', '1982-02-28', 86000, 30),
(7566, 'JONES', 'MANAGER', '1981-04-02', 32000, 20),
(7654, 'MARTIN', 'SALESMAN', '1981-09-29', 72000, 30), 
(7698, 'BLAKE', 'MANAGER', '1981-10-02', 72000, 30),
(7782, 'CLARK', 'MANAGER', '1987-04-15', 87000, 10),
(7788, 'SCOTT', 'ANALYST', '1980-06-28', 40000, 20),
(7839, 'KING', 'PRESIDENT', '1984-09-29', 98000, 10),
(7844, 'TURN', 'SALESMAN', '1986-11-11', 62000, 30),
(7876, 'ADAMS', 'CLERK', '1986-04-18', 28000, 20),
(7900, 'JAMES', 'CLERK', '1982-01-01', 18000, 30),
(7902, 'FORD', 'ANALYST', '1983-08-27', 38000, 20),
(7934, 'MILLER', 'CLERK', '1983-10-15', 10000, 10),
(7365, 'WARNER', 'ANALYST', '1990-01-01', 42000, 20);
SELECT * FROM EMPDETAILS;

-- GROUP BY clause : 
SELECT JOB, COUNT(*) FROM EMPDETAILS GROUP BY JOB;
SELECT JOB, COUNT(*) NOOFEMPLOYEE FROM EMPDETAILS GROUP BY JOB;

SELECT JOB, MIN(SALARY) MAXSAL, MAX(SALARY) MINSAL, AVG(SALARY) AVGSAL FROM EMPDETAILS GROUP BY JOB;

SELECT JOB, COUNT(*) NOOFEMPLOYEE , DEPTNO FROM EMPDETAILS GROUP BY JOB, DEPTNO;
-- HAVING clause : 
SELECT JOB, COUNT(*) NOOFEMPLOYEE FROM EMPDETAILS GROUP BY JOB HAVING COUNT(*) > 3;
SELECT JOB, SUM(SALARY)  NOOFEMPLOYEE FROM EMPDETAILS GROUP BY JOB HAVING SUM(SALARY) > 100000;

--ROLLUP CLAUSE
SELECT JOB, COUNT(*) FROM EMPDETAILS GROUP BY ROLLUP(JOB);

--CUBE CLAUSE
SELECT JOB, COUNT(*), DEPTNO FROM EMPDETAILS GROUP BY CUBE(JOB, DEPTNO);

